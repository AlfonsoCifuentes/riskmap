<!DOCTYPE html>
<html>
<head>
    <title>Debug Frontend - Artículo del Día</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        .debug { background: #f0f0f0; padding: 10px; margin: 10px 0; }
        .error { background: #ffe6e6; color: red; }
        .success { background: #e6ffe6; color: green; }
    </style>
</head>
<body>
    <h1>🔍 Debug - Artículo del Día</h1>
    
    <div id="debug-log" class="debug">
        <h3>Log de depuración:</h3>
        <div id="log-content"></div>
    </div>
    
    <div id="article-result" class="debug">
        <h3>Resultado del artículo:</h3>
        <div id="article-content"></div>
    </div>

    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log-content');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : (type === 'success' ? 'success' : '');
            logDiv.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            console.log(message);
        }

        async function testArticleOfDay() {
            log('🚀 Iniciando test del artículo del día...');
            
            try {
                log('📡 Haciendo fetch a http://localhost:5000/api/article-of-day');
                const response = await fetch('http://localhost:5000/api/article-of-day');
                
                log(`📊 Response status: ${response.status}`, response.ok ? 'success' : 'error');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                log(`📦 Data received: ${JSON.stringify(data, null, 2)}`, 'success');
                
                // Mostrar los datos
                const articleDiv = document.getElementById('article-content');
                articleDiv.innerHTML = `
                    <h4>📰 ${data.title || 'Sin título'}</h4>
                    <p><strong>📅 Fecha:</strong> ${data.created_at || 'Sin fecha'}</p>
                    <p><strong>📍 Fuente:</strong> ${data.source || 'Sin fuente'}</p>
                    <p><strong>⚠️ Riesgo:</strong> <span style="color: red;">${data.risk_level || 'Sin riesgo'}</span></p>
                    <p><strong>🔗 Tipo de conflicto:</strong> ${data.conflict_type || 'Sin tipo'}</p>
                    <p><strong>🌍 País:</strong> ${data.country || 'Sin país'}</p>
                    <p><strong>🖼️ Imagen:</strong> ${data.image_url ? '✅ Disponible' : '❌ No disponible'}</p>
                    ${data.image_url ? `<img src="${data.image_url}" style="max-width: 300px; border: 1px solid #ccc;">` : ''}
                    <p><strong>📝 Contenido:</strong></p>
                    <div style="background: #f9f9f9; padding: 10px; border-left: 3px solid #007bff;">
                        ${data.content || 'Sin contenido'}
                    </div>
                `;
                
                log('✅ Artículo mostrado correctamente', 'success');
                
            } catch (error) {
                log(`💥 Error: ${error.message}`, 'error');
                document.getElementById('article-content').innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }

        // Ejecutar el test al cargar la página
        window.onload = testArticleOfDay;
    </script>
</body>
</html>
